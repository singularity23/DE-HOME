<!doctype html>
<html lang="EN">

	<head>
		<meta name="viewport" content="width=device-width , initial-scale=1.0, maximum-scale=1.0" />
		<meta charset="utf-8" />
		<title>Aspen Feeder Relay Query Tool</title>
		<style>
			* {
				box-sizing: border-box;
				/* color: black; */
				/* margin: 0 10px; */
				/* margin: 10px; */
				/* padding: 10px; */
			}

			div {
				margin: 10px;
			}

			body {
				font-family: Arial, Helvetica, sans-serif;
				font-size: 1.382rem;
				background: #FFF;
			}

			#code-container,
			#render-container,
			#file-container,
			#search-container {
				width: 800px;
				max-width: 90%;
				margin: auto;
				border: 1px solid #d0d0d0;
				background-color: #f3f3f3;
				padding: 20px, 20px;
				display: block;

				/* align-self: normal; */
			}

			#search-container input {
				padding: 10px 10px;
				margin: 10px 10px;
				border-radius: 0px;
				border-style: inset;
				background-color: white;
				border-width: 2px;
				border-color: #d0d0d0;
				font-size: 1.382rem;
			}

			#search-container input:valid {
				background-color: #dcf1da;
			}

			#search-container input:invalid {
				background-color: #fedad0;
			}

			input[type="text"]:focus-visible,
			input[type="text"]:focus-within,
			input[type="text"]:focus {
				outline: grey solid 1px;
				border-radius: 0px;
			}


			.container {
				min-width: 1000px;
				width: 90%;
				display: block;
				box-sizing: border-box;
				margin: auto;
				padding: 20px;
			}

			#search-container label {
				padding: 10px 10px;
				font-weight: bold;
				align-content: center;
				text-align: right;
			}

			.button {
				transition-duration: 0.4s;
				cursor: pointer;
				padding: 10px 10px;
				margin: 10px 10px 10px 0;
				font-weight: bold;
				font-size: 1.382rem;
			}

			.button1 {
				background-color: white;
				color: black;
				border: 2px solid #04AA6D;
			}

			.button1:hover {
				background-color: #04AA6D;
				color: white;
			}

			.button2 {
				background-color: white;
				color: black;
				border: 2px solid #008CBA;
			}

			.button2:hover {
				background-color: #008CBA;
				color: white;
			}

			.section {
				padding: 10px 20px;
			}

			.preview {
				width: 65%;
				align-content: center;
			}

			.preview_box {
				display: inline-block;
				border: 1px solid #ddd;
				text-decoration: none;
				display: flex;
				flex-wrap: nowrap;
				justify-content: space-between;
				background-color: white;
				vertical-align: middle;
			}

			form {
				display: block;
				padding: 5rem 0;
			}

			#warning {
				color: #fa4616;
				font-size: 0.8rem;
			}

			fieldset {
				width: 40%;
				margin: auto;
			}

			legend {
				font-size: 1.2rem;
			}

			video {
				/* margin: auto; */
				/* padding: 0px; */
				/* box-sizing: content-box; */
				display: block;
				flex-direction: column;
				align-content: stretch;
				align-items: center;
				justify-content: space-around;
			}
		</style>
	</head>

	<body>
		<form action="./aspen.html#" class="container">
			<fieldset id="search-container">
				<legend>PN Info Query from ASPEN</legend>
				<div class="preview_box" style="display:none;">
					<label for="feeder-input">Feeder ID:</label>
					<input class="preview" type="text" name="feeder-input" id="feeder-input" placeholder="e.g. CSQ 12F72"
						pattern="^\w{3}\s(4|12|25|35)(F)\d{2,3}\w?" required title="please follow the pattern " />
					<button class="button button2" type="button" name="button_1" id="submit_1">Search</button>
					<em id="warning"></em>
				</div>
				<br />
				<small>
					<div>Drag the following link to your bookmark bar on your browser, and click it when you are in the result
						window or watch the video below (<mark>Updated: <span id="updated"></span></mark>)
						<ul>
							<li><a id="output" title="output"
									 href="javascript:(function()%7Bjavascript%3A%20(function%20()%20%7Bconst%20text_1%20%3D'%5Cn%20%20%20%20%3Cdiv%20style%3D%22position%3A%20relative%3B%20top%3A%200%3B%20left%3A%200%3B%20width%3A%20100%25%3B%20background%3A%20white%3B%20padding%3A%2010px%3B%20box-shadow%3A%200%202px%205px%20rgba(0%2C%200%2C%200%2C%200.2)%3B%20display%3A%20flex%3B%20align-items%3A%20center%3B%20justify-content%3A%20center%3B%20z-index%3A%201000%3B%22%3E%5Cn%20%20%20%20%20%20%20%20%3Cinput%20type%3D%22text%22%20id%3D%22searchInput%22%20placeholder%3D%22Search...%22%20style%3D%22padding%3A%208px%3B%20width%3A%20250px%3B%20border%3A%201px%20solid%20%23ccc%3B%20border-radius%3A%204px%3B%20margin-right%3A%2010px%3B%22%3E%5Cn%20%20%20%20%20%20%20%20%3Cbutton%20id%3D%22searchButton%22%20style%3D%22padding%3A%208px%2012px%3B%20border%3A%20none%3B%20background%3A%20blue%3B%20color%3A%20white%3B%20border-radius%3A%204px%3B%20cursor%3A%20pointer%3B%22%3ESearch%3C%2Fbutton%3E%5Cn%20%20%20%20%3C%2Fdiv%3E%5Cn'const%20text_2%20%3D%20%60document.getElementById(%22searchButton%22).addEventListener(%22click%22%2C(()%3D%3E%7Bconst%20F%3Ddocument.getElementById(%22searchInput%22).value%3Bdocument.getElementById(%22sql-editor%22).innerText%3D%22SELECT%20R.S01%20AS%20DEVICE%2C%20Q.RELAYTYPE%20AS%20RELAY%2C%20T.SETTINGNAME%20AS%20ELEMENT%2C%20CASE%20WHEN%20T.SETTINGNAME%20NOT%20LIKE%20'%25C'%20AND%20T.SETTINGNAME%20NOT%20LIKE%20'%25D'%20AND%20S.GROUPNAME%20%3D%20'1'%20AND%20DBMS_LOB.SUBSTR(S.SETTING%2C%204000)%20%3C%3E%20'OFF'%20THEN%20UPPER(TO_NUMBER(DBMS_LOB.SUBSTR(S.SETTING%2C%204000))%20*%20(%20SELECT%20TO_NUMBER(DBMS_LOB.SUBSTR(S.SETTING%2C%204000))%20AS%20CTR%20FROM%20TSETTING1%20S%2C%20TSETTYPE1%20T%2C%20TRELAY%20R%2C%20TREQUEST%20Q%20WHERE%20R.S01%20LIKE%20'%5C%24%7BF%7D%25'%20AND%20R.RELAYTYPE%20LIKE%20'SEL%25'%20AND%20R.ID%20%3D%20Q.RELAYID%20AND%20Q.ID%20%3D%20S.REQUESTID%20AND%20T.RELAYTYPE%20%3D%20Q.RELAYTYPE%20AND%20T.ROWNUMBER%20%3D%20S.ROWNUMBER%20AND%20S.GROUPNAME%20%3D%20'1'%20AND%20T.SETTINGNAME%20%3D%20'CTR'%20AND%20UPPER(Q.S02)%20%3D%20'IN%20SERVICE'))%20WHEN%20T.SETTINGNAME%20LIKE%20'67%25D'%20AND%20S.GROUPNAME%20%3D%20'1'%20AND%20DBMS_LOB.SUBSTR(S.SETTING%2C%204000)%20%3C%3E%20'OFF'%20THEN%20UPPER(TO_NUMBER(DBMS_LOB.SUBSTR(S.SETTING%2C%204000))%20%2F%2060)%20ELSE%20DBMS_LOB.SUBSTR(S.SETTING%2C%204000)%20END%20AS%20SETTING%2C%20Q.M01%20AS%20MEMO%20FROM%20TSETTING1%20S%2C%20TSETTYPE1%20T%2C%20TRELAY%20R%2C%20TREQUEST%20Q%20WHERE%20R.S01%20LIKE%20'%5C%24%7BF%7D%25'%20AND%20R.RELAYTYPE%20LIKE%20'SEL%25'%20AND%20R.ID%20%3D%20Q.RELAYID%20AND%20Q.ID%20%3D%20S.REQUESTID%20AND%20T.RELAYTYPE%20%3D%20Q.RELAYTYPE%20AND%20T.ROWNUMBER%20%3D%20S.ROWNUMBER%20AND%20UPPER(Q.S02)%20%3D%20'IN%20SERVICE'%20AND%20(%20(%20S.GROUPNAME%20%3D%20'1'%20AND%20T.SETTINGNAME%20IN%20(%20'51P1P'%2C%20'51P1TD'%2C%20'51P1C'%2C%20'50P1P'%2C%20'50P2P'%2C%20'50P3P'%2C%20'50P4P'%2C%20'50P5P'%2C%20'67P2D'%2C%20'67P3D'%2C%20'67P4D'%2C%20'51G1P'%2C%20'51G1TD'%2C%20'51G1C'%2C%20'50G1P'%2C%20'50G5P'%2C%20'51PP'%2C%20'51PTD'%2C%20'51PC'%2C%20'51GP'%2C%20'51GTD'%2C%20'51GC'%2C%20'51P'%2C%20'51TD'%2C%20'51C'%2C%20'50L'%2C%20'50H'%2C%20'51NP'%2C%20'51NTD'%2C%20'51NC'%2C%20'50NL'%2C%20'50NH'%2C%20'51QP'%2C%20'51QTD'%2C%20'51QC'%2C%20'50Q'%20)%20)%20OR%20(%20S.GROUPNAME%20%3D%20'L1'%20AND%20(%20(T.SETTINGNAME%20LIKE%20(%20SELECT%20S.SETTING%20AS%20TR%20FROM%20TSETTING1%20S%2C%20TSETTYPE1%20T%2C%20TRELAY%20R%2C%20TREQUEST%20Q%20WHERE%20R.S01%20LIKE%20'%5C%24%7BF%7D%25'%20AND%20R.RELAYTYPE%20LIKE%20'SEL%25'%20AND%20R.ID%20%3D%20Q.RELAYID%20AND%20Q.ID%20%3D%20S.REQUESTID%20AND%20T.RELAYTYPE%20%3D%20Q.RELAYTYPE%20AND%20T.ROWNUMBER%20%3D%20S.ROWNUMBER%20AND%20S.GROUPNAME%20%3D%20'L1'%20AND%20T.SETTINGNAME%20%3D%20'TR'%20AND%20UPPER(Q.S02)%3D'IN%20SERVICE'))%20OR%20T.SETTINGNAME%20IN('51P1TC'%2C%20'51PTC')%20)%20)%20)%20UNION%20ALL%20SELECT%20R.S01%20AS%20DEVICE%2C%20R.S04%20AS%20RELAY%2C%20R.S06%20AS%20VENDER%2C%20Q.RELAYTYPE%2C%20Q.M01%20AS%20MEMO%20FROM%20TRELAY%20R%2C%20TREQUEST%20Q%20WHERE%20R.S01%20LIKE%20'%5C%24%7BF%7D%25'%20AND%20UPPER(R.RELAYTYPE)%20LIKE%20'ELECTRO%25'%20AND%20R.ID%20%3D%20Q.RELAYID%20AND%20UPPER(Q.S02)%3D%20'IN%20SERVICE'%22%2C%22none%22!%3D%3Ddocument.getElementById(%22sql-editor-section%22)%3F.style.display%26%26runQuery()%2CsetTimeout((()%3D%3E%7BN()%7D)%2C6e3)%3Bconst%20E%3DE%3D%3E%7Blet%20T%3D%22%22%3Bif(T%2B%3D%7BG%3A%22GND%20%22%2CP%3A%22PHS%20%22%2CQ%3A%22NEG%20%22%2CN%3A%22GND%20%22%7D%5BE.charAt(2)%5D%7C%7C%22PHS%20%22%2C%2F%5E50P%5B234%5D%2F.test(E))T%3D%22Definite%20Time%20Pick%20Up(A)%22%3Belse%20if(%2F%5E67P%5B234%5D%2F.test(E))T%3D%22Definite%20Time%20Delay(s)%22%3Belse%7B%2F%5E50%2F.test(E)%3FT%2B%3D%22Inst.%20Overcurrent%20%22%3A%2F%5E51%2F.test(E)%26%26(T%2B%3D%22Timed%20Overcurrent%20%22)%3Bconst%20S%3D%7BP%3A%22Pick%20Up(A)%22%2CC%3A%22Curve%22%2CTD%3A%22Time%20Dial%22%2CTC%3A%22Torque%20Control%22%7D%2CN%3DE.slice(-1)%2CR%3DE.slice(-2)%3BS%5BR%5D%3FT%2B%3DS%5BR%5D%3AS%5BN%5D%26%26(T%2B%3DS%5BN%5D)%7Dreturn%2F%5E50%5BPG%5D5%2F.test(E)%26%26(T%2B%3D%22%20(Live%20Line)%22)%2C%2F%5ESV%5C%5Cd%3F%5C%5Cw%2B%2F.test(E)%26%26(T%3D%22_Trip%20Equation%22)%2CT%7D%3BN%3D()%3D%3E%7Bconst%20T%3DArray.from(_C1MVCCtrl5._ncc)%2CS%3DT.length%3Bif(S%3E10)for(let%20N%3D0%3BN%3CS%3BN%2B%2B)T%5BN%5D%5B4%5D%3DE(T%5BN%5D%5B2%5D)%3Belse%20document.body.style.fontFamily%3D%22monospace%22%3Balert(%22Query%20Completed%22)%7D%7D))%3B%60typeof%20switchEditor%20%3D%3D%3D%20'function'%20%26%26%20switchEditor()const%20searchBar%20%3D%20document.createElement('div')searchBar.innerHTML%20%3D%20text_1document.body.insertBefore(searchBar%2C%20document.body.firstChild)const%20script%20%3D%20document.createElement('script')script.textContent%20%3D%20text_2document.body.appendChild(script)%7D)()%7D)()">ASPEN
									Result Download</a>
							</li>
						</ul>
					</div>
				</small><br />
				<hr />
				<footer>
					<small>Thanks <em>Joel McFaul</em> for the original idea. Please report issues to <a
							href="mailto:kan.tang@bchydro.com">Kan Tang</a>
					</small>
				</footer>
			</fieldset>
		</form>
		<div class="container">
			<div id="file-container">
				<video width="800" controls>
					<source media="(min-width:800px)" src="../../SiteAssets/video/0905.mp4" type="video/mp4">
				</video>
			</div>
		</div>

	</body>
	<script>
		document.getElementById('updated').innerText = new Intl.DateTimeFormat("en-CA").format(new Date(document.lastModified));
	</script>

</html>
